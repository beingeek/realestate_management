{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2023-11-01 10:49:21.342692",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Customer Payment",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "html": "{% set customers = frappe.get_all('Customer', filters={'name': doc.customer_name}, fields=['custom_address', 'custom_contact_no']) %}\n{% set document_number = doc.document_number %}\n\n{% set total_previous_payments = frappe.db.sql(\"\"\"\n    SELECT \n        SUM(paid_total) as total_paid,\n        SUM(sales_amount) as total_sales\n    FROM (\n        SELECT \n            SUM(total_paid_amount) + COALESCE(\n                (SELECT SUM(COALESCE(paid_amount, 0)) \n                 FROM `tabProperty Transfer` tpt\n                 WHERE name = %(document_number)s AND docstatus = 1), 0\n            ) as paid_total,\n            0 as sales_amount\n        FROM `tabCustomer Payment` tcp\n        WHERE document_number = %(document_number)s AND docstatus = 1 \n        UNION ALL\n        SELECT  \n            0 as paid_total, \n            total_sales_amount as sales_amount\n        FROM `tabPlot Booking` tpb \n        WHERE tpb.name = %(document_number)s\n        UNION ALL\n        SELECT \n            0 as paid_total, \n            transfer_amount + paid_amount as sales_amount\n        FROM `tabProperty Transfer` tpt \n        WHERE tpt.name = %(document_number)s\n    ) x\n\"\"\", { 'document_number': document_number, 'document_type': document_type }, as_dict=true) %}\n\n{% set total_paid_amount_sum = total_previous_payments[0]['total_paid'] if total_previous_payments and total_previous_payments[0]['total_paid'] is not none else 0 %}\n{% set sales_amount = total_previous_payments[0]['total_sales'] if total_previous_payments and total_previous_payments[0]['total_sales'] is not none else 0 %}\n{% set difference = sales_amount - total_paid_amount_sum %}\n\n\n<style>\n    @media print {\n        .print-heading {\n            page-break-before: always;\n            text-align: center;\n            margin: 0 auto;\n            max-width: 800px;\n            display: flex;\n            align-items: center;\n            justify-content: space-between;\n        }\n        .print-heading img {\n            height: 85px;\n        }\n        .text-container {\n            text-align: center;\n            flex-grow: 1;\n            margin-left: 5px; /* Adjust the margin as needed */\n        }\n    }\n</style>\n\n <div class=\"page-break\">\n    <div class=\"print-heading\">\n        <img src=\"/private/files/logo.png\" alt=\"TBD\">\n        <div class=\"text-container\">\n            <h3>{{doc.company}}</h3>\n            <h4>Customer Payment</h4>\n        </div>\n    </div> \n\n    <!-- Content Section -->\n\n    <br>\n    <div class=\"row section-break\">\n        <div class=\"col-xs-6 column-break\">\n            <!-- Customer Details -->\n            <div class=\"row\">\n                <div class=\"col-xs-5 text-left\">\n                    <label>Customer Name</label>\n                </div>\n                <div class=\"col-xs-6 value\">\n                    {{ doc.customer_name }} \n                </div>\n            </div>\n            <div class=\"row\">\n            <div class=\"col-xs-5 text-left\">\n                <label>Contact No.</label>\n            </div>\n            <div class=\"col-xs-6 value\">\n                {% if customers and customers[0]['custom_contact_no'] %}\n                    {{ customers[0]['custom_contact_no'] }} \n                {% else %}\n                    N/A\n                {% endif %}\n            </div>\n        </div>\n        <div class=\"row\">\n            <div class=\"col-xs-5 text-left\">\n                <label>Address.</label>\n            </div>\n            <div class=\"col-xs-6 value\">\n                {% if customers and customers[0]['custom_address'] %}\n                    {{ customers[0]['custom_address'] }} \n                {% else %}\n                    N/A\n                {% endif %}\n            </div>\n        </div>\n\n            <div class=\"row\">\n                <div class=\"col-xs-5 text-left\">\n                    <label> Paid Amount</label>\n                </div>\n                <div class=\"col-xs-6 value\">\n                    {{ doc.get_formatted(\"total_paid_amount\", doc)}}\n                </div>\n            </div>\n\n            <!-- Other customer details... -->\n        </div>\n        <div class=\"col-xs-6 column-break\">\n            <!-- Booking Date and Plot Details  -->\n            <div class=\"row\">\n                <div class=\"col-xs-5 text-left\">\n                    <label>Payment No & Date</label>\n                </div>\n                <div class=\"col-xs-6 value\">\n                    {{doc.name}} - {{frappe.utils.formatdate(doc.payment_date)}}\n                </div>\n            </div>\n            <div class=\"row\">\n                <div class=\"col-xs-5 text-left\">\n                    <label>Scheme & Plot no</label>\n                </div>\n                <div class=\"col-xs-6 value\">\n                    {{doc.project_name}} -  {{doc.plot_no}}\n                </div>\n            </div>\n            <div class=\"row\">\n                <div class=\"col-xs-5 text-left\">\n                    <label>Booking No</label>\n                </div>\n                <div class=\"col-xs-6 value\">\n                    {{doc.document_number}}\n                </div>\n            </div>\n            <div class=\"row\">\n                <div class=\"col-xs-5 text-left\">\n                    <label>Book No.</label>\n                </div>\n                <div class=\"col-xs-6 value\">\n                    {{doc.book_number}}\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <table class=\"table table-bordered\">\n        <!-- Installment table content... -->\n        <tbody>\n            <tr>\n                <th style=\"text-align: center;\">Sr</th>\n                <th style=\"text-align: center;\">Ins. Due Date</th>\n                <th style=\"text-align: left;\">Description</th>\n                <th class=\"text-right\"> Receivable Amount</th>\n                <th class=\"text-right\"> Paid Amount</th>\n                <th class=\"text-right\"> Balance Amount</th>\n            </tr>\n            {%- for row in doc.installment -%}\n            <tr>\n                <td style=\"width: 5%; text-align:center ;\">{{ row.idx }}</td>\n                <td style=\"width: 12%;text-align:center\">{{frappe.utils.formatdate(row.date)}}</td>\n                <td style=\"width: 23%; text-align: left;\">{{ row.installment }}</td>\n                <td style=\"width: 18%; text-align: right;\">{{ row.get_formatted(\"receivable_amount\", doc) }}</td>\n                <td style=\"width: 14%; text-align: right;\">{{ row.get_formatted(\"paid_amount\", doc) }}</td>\n                <td style=\"width: 14%; text-align: right;\">{{ row.get_formatted(\"remaining_amount\", doc) }}</td>\n            </tr>\n            {%- endfor -%}\n        </tbody>\n    </table>\n    <table class=\"table table-bordered\">\n            <!-- Payment type table content... -->\n            <tbody>\n                <tr>\n                    <th style=\"text-align: center;\">Sr</th>\n                    <th style=\"text-align: center;\">Mode of Payment </th>\n                    <th class=\"text-right\"> Amount</th>\n                    <th style=\"text-align: center;\"> Cheque No</th>\n                    <th style=\"text-align: center;\"> Cheque Date</th>\n                </tr>\n                {%- for row in doc.payment_type -%}\n                <tr>\n                    <td style=\"width: 5%;  text-align:center ;\">{{ row.idx }}</td>\n                    <td style=\"width: 15%; text-align:center;\">{{ row.mode_of_payment }}</td>\n                    <td style=\"width: 15%; text-align:right;\">{{ row.get_formatted(\"amount\", doc) }}</td>\n                    <td style=\"width: 15%; text-align:center;\">{{ row.cheque_no}}</td>\n                    <td style=\"width: 15%; text-align:center\">{{frappe.utils.formatdate(row.cheque_date)}}</td>\n                </tr>\n                {%- endfor -%}\n            </tbody>\n        </table>\n        <table class=\"table table-bordered\">\n            <tbody>\n                <tr>\n                    <th style=\"text-align: center;\"> Plot Sales Amount </th>\n                    <th style=\"text-align: center;\"> Payment Received </th>\n                    <th style=\"text-align: center;\"> Remaining Balance</th>\n                </tr>\n                <tr>\n                    <td style=\"width: 14%; text-align: center;\"> \u20a8 {{ \"{:,.2f}\".format(sales_amount) }}</td>\n                    <td style=\"width: 16%; text-align: center;\"> \u20a8 {{ \"{:,.2f}\".format(total_paid_amount_sum) }} </td>\n                    <td style=\"width: 14%; text-align: center;\"> \u20a8 {{ \"{:,.2f}\".format(difference) }}</td>\n                </tr> \n            </tbody>\n        </table>\n\n        <div class=\"row\" style=\"text-align: center; font-weight: bold;\">\n        <p>This is a system-generated document and does not require any stamp or signature.</p>\n    </div>\n\n    <!-- Content Section -->\n    \n    <div class=\"row\" style=\"height: 6em;\"></div>\n\n    <div class=\"row\" style=\"text-align: center; font-weight: bold;\">\n        <h4>Customer Payment - Office Copy</h4>\n    </div>\n\n    <div class=\"row section-break\">\n        <div class=\"col-xs-6 column-break\">\n            <!-- Customer Details -->\n            <div class=\"row\">\n                <div class=\"col-xs-5 text-left\">\n                    <label>Customer Name</label>\n                </div>\n                <div class=\"col-xs-6 value\">\n                    {{ doc.customer_name }} \n                </div>\n            </div>\n            <div class=\"row\">\n            <div class=\"col-xs-5 text-left\">\n                <label>Contact No.</label>\n            </div>\n            <div class=\"col-xs-6 value\">\n                {% if customers and customers[0]['custom_contact_no'] %}\n                    {{ customers[0]['custom_contact_no'] }} \n                {% else %}\n                    N/A\n                {% endif %}\n            </div>\n        </div>\n        <div class=\"row\">\n            <div class=\"col-xs-5 text-left\">\n                <label>Address.</label>\n            </div>\n            <div class=\"col-xs-6 value\">\n                {% if customers and customers[0]['custom_address'] %}\n                    {{ customers[0]['custom_address'] }} \n                {% else %}\n                    N/A\n                {% endif %}\n            </div>\n        </div>\n\n            <div class=\"row\">\n                <div class=\"col-xs-5 text-left\">\n                    <label> Paid Amount</label>\n                </div>\n                <div class=\"col-xs-6 value\">\n                    {{ doc.get_formatted(\"total_paid_amount\", doc)}}\n                </div>\n            </div>\n\n            <!-- Other customer details... -->\n        </div>\n        <div class=\"col-xs-6 column-break\">\n            <!-- Booking Date and Plot Details  -->\n            <div class=\"row\">\n                <div class=\"col-xs-5 text-left\">\n                    <label>Payment No & Date</label>\n                </div>\n                <div class=\"col-xs-6 value\">\n                    {{doc.name}} - {{frappe.utils.formatdate(doc.payment_date)}}\n                </div>\n            </div>\n            <div class=\"row\">\n                <div class=\"col-xs-5 text-left\">\n                    <label>Scheme & Plot no</label>\n                </div>\n                <div class=\"col-xs-6 value\">\n                    {{doc.project_name}} -  {{doc.plot_no}}\n                </div>\n            </div>\n            <div class=\"row\">\n                <div class=\"col-xs-5 text-left\">\n                    <label>Booking No</label>\n                </div>\n                <div class=\"col-xs-6 value\">\n                    {{doc.document_number}}\n                </div>\n            </div>\n            <div class=\"row\">\n                <div class=\"col-xs-5 text-left\">\n                    <label>Book No.</label>\n                </div>\n                <div class=\"col-xs-6 value\">\n                    {{doc.book_number}}\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <table class=\"table table-bordered\">\n        <!-- Installment table content... -->\n        <tbody>\n            <tr>\n                <th style=\"text-align: center;\">Sr</th>\n                <th style=\"text-align: center;\">Ins. Due Date</th>\n                <th style=\"text-align: left;\">Description</th>\n                <th class=\"text-right\"> Receivable Amount</th>\n                <th class=\"text-right\"> Paid Amount</th>\n                <th class=\"text-right\"> Balance Amount</th>\n            </tr>\n            {%- for row in doc.installment -%}\n            <tr>\n                <td style=\"width: 5%; text-align:center ;\">{{ row.idx }}</td>\n                <td style=\"width: 12%;text-align:center\">{{frappe.utils.formatdate(row.date)}}</td>\n                <td style=\"width: 23%; text-align: left;\">{{ row.installment }}</td>\n                <td style=\"width: 18%; text-align: right;\">{{ row.get_formatted(\"receivable_amount\", doc) }}</td>\n                <td style=\"width: 14%; text-align: right;\">{{ row.get_formatted(\"paid_amount\", doc) }}</td>\n                <td style=\"width: 14%; text-align: right;\">{{ row.get_formatted(\"remaining_amount\", doc) }}</td>\n            </tr>\n            {%- endfor -%}\n        </tbody>\n    </table>\n    <table class=\"table table-bordered\">\n            <!-- Payment type table content... -->\n            <tbody>\n                <tr>\n                    <th style=\"text-align: center;\">Sr</th>\n                    <th style=\"text-align: center;\">Mode of Payment </th>\n                    <th class=\"text-right\"> Amount</th>\n                    <th style=\"text-align: center;\"> Cheque No</th>\n                    <th style=\"text-align: center;\"> Cheque Date</th>\n                </tr>\n                {%- for row in doc.payment_type -%}\n                <tr>\n                    <td style=\"width: 5%;  text-align:center ;\">{{ row.idx }}</td>\n                    <td style=\"width: 15%; text-align:center;\">{{ row.mode_of_payment }}</td>\n                    <td style=\"width: 15%; text-align:right;\">{{ row.get_formatted(\"amount\", doc) }}</td>\n                    <td style=\"width: 15%; text-align:center;\">{{ row.cheque_no}}</td>\n                    <td style=\"width: 15%; text-align:center\">{{frappe.utils.formatdate(row.cheque_date)}}</td>\n                </tr>\n                {%- endfor -%}\n            </tbody>\n        </table>\n\n        <table class=\"table table-bordered\">\n            <tbody>\n                <tr>\n                    <th style=\"text-align: center;\"> Plot Sales Amount </th>\n                    <th style=\"text-align: center;\"> Payment Received </th>\n                    <th style=\"text-align: center;\"> Remaining Balance</th>\n\n                </tr>\n                <tr>\n                    <td style=\"width: 14%; text-align: center;\"> \u20a8 {{ \"{:,.2f}\".format(sales_amount) }}</td>\n                    <td style=\"width: 16%; text-align: center;\"> \u20a8 {{ \"{:,.2f}\".format(total_paid_amount_sum) }} </td>\n                    <td style=\"width: 14%; text-align: center;\"> \u20a8 {{ \"{:,.2f}\".format(difference) }}</td>\n                </tr> \n            </tbody>\n        </table>\n\n\n\n",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2023-11-02 23:26:47.928780",
 "modified_by": "Administrator",
 "module": "Realestate Account",
 "name": "Customer Payment",
 "owner": "Administrator",
 "page_number": "Hide",
 "print_designer": 0,
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}